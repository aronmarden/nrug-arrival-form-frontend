"use strict";(self.webpackChunknrug_arrival_form_frontend=self.webpackChunknrug_arrival_form_frontend||[]).push([[590],{6945:function(e,t,s){var n;s.d(t,{m:function(){return a}});var i=new Promise((function(e){n=e})),a=Object.freeze({onReplayReady:n,sessionReplayInitialized:i})},7661:function(e,t,s){s.d(t,{o:function(){return p}});var n=s(2982),i=s(5671),a=s(3144),r=s(7326),o=s(136),h=s(9388),l=s(3197),u=s(3114),d=s(2041),c=s(8464),v=s(9471),p=function(e){(0,o.Z)(s,e);var t=(0,h.Z)(s);function s(e,n,a){var o,h;return(0,i.Z)(this,s),(h=t.call(this,a)).endpoint=e,h.opts=n||{},h.started=!1,h.timeoutHandle=null,h.aborted=!1,h.harvest=new d.M(h.sharedContext),(0,c.L)(h.unload.bind((0,r.Z)(h))),null===(o=h.sharedContext)||void 0===o||o.ee.on(v.wO.RESET,(function(){return h.runHarvest({forceNoRetry:!0})})),h}return(0,a.Z)(s,[{key:"unload",value:function(){this.aborted||(this.opts.onUnload&&this.opts.onUnload(),this.runHarvest({unload:!0}))}},{key:"startTimer",value:function(e,t){this.interval=e,this.started=!0,this.scheduleHarvest(null!=t?t:this.interval)}},{key:"stopTimer",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.aborted=e,this.started=!1,this.timeoutHandle&&clearTimeout(this.timeoutHandle)}},{key:"scheduleHarvest",value:function(e,t){var s=this;this.timeoutHandle||(null==e&&(e=this.interval),this.timeoutHandle=setTimeout((function(){s.timeoutHandle=null,s.runHarvest(t)}),1e3*e))}},{key:"runHarvest",value:function(e){var t=this;if(!this.aborted){var s,i,a=function(s){null!==e&&void 0!==e&&e.forceNoRetry&&(s.retry=!1),t.onHarvestFinished(e,s)},r=[];if(this.opts.getPayload){if(!(s=l.qD({isFinalHarvest:null===e||void 0===e?void 0:e.unload})))return!1;var o=!(null!==e&&void 0!==e&&e.unload)&&s===l.Be;if(!(i=this.opts.getPayload({retry:o})))return void(this.started&&this.scheduleHarvest());i="[object Array]"===Object.prototype.toString.call(i)?i:[i],r.push.apply(r,(0,n.Z)(i))}var h=function(e){return t.harvest.sendX(e)};r.length?h=this.opts.raw?function(e){return t.harvest._send(e)}:function(e){return t.harvest.send(e)}:r.push(void 0),r.forEach((function(n){h({endpoint:t.endpoint,payload:n,opts:e,submitMethod:s,cbFinished:a,customUrl:t.opts.customUrl,raw:t.opts.raw})})),this.started&&this.scheduleHarvest()}}},{key:"onHarvestFinished",value:function(e,t){if(this.opts.onFinished&&this.opts.onFinished(t),t.sent&&t.retry){var s=t.delay||this.opts.retryDelay;this.started&&s?(clearTimeout(this.timeoutHandle),this.timeoutHandle=null,this.scheduleHarvest(s,e)):!this.started&&s&&this.scheduleHarvest(s,e)}}}]),s}(u.w)},8464:function(e,t,s){s.d(t,{L:function(){return h}});var n=s(7762),i=s(1997),a=s(3980),r=s(536);if(a.v6){a._A.cleanupTasks=[];var o=a._A.close;a._A.close=function(){var e,t=(0,n.Z)(a._A.cleanupTasks);try{for(t.s();!(e=t.n()).done;){(0,e.value)()}}catch(s){t.e(s)}finally{t.f()}o()}}function h(e){a.il?((0,r.N)(e,!0),(0,i.bP)("pagehide",e)):a.v6&&a._A.cleanupTasks.push(e)}},3685:function(e,t,s){s.r(t),s.d(t,{AVG_COMPRESSION:function(){return H},Aggregate:function(){return D},IDEAL_PAYLOAD_SIZE:function(){return U},MAX_PAYLOAD_SIZE:function(){return z},RRWEB_EVENT_TYPES:function(){return C}});var n,i,a,r,o=s(1413),h=s(2982),l=s(4165),u=s(5861),d=s(885),c=s(5671),v=s(3144),p=s(7326),m=s(136),f=s(9388),y=s(4942),g=s(4613),b=s(7661),k=s(1477),R=s(8038),_=s(8958),S=s(9471),E=s(1527),I=s(6945),M=s(6323),T=s(1760),F=s(3980),O=s(6477),w=s(5894),Z=s(9025),A=s(8374),H=.12,C={DomContentLoaded:0,Load:1,FullSnapshot:2,IncrementalSnapshot:3,Meta:4,Custom:5},P={message:"Session was reset",sm:"Reset"},x={message:"Recorder failed to import",sm:"Import"},K={message:"429: Too Many Requests",sm:"Too-Many"},L={message:"Payload was too large",sm:"Too-Big"},B={message:"Session Entity was set to OFF on another tab",sm:"Cross-Tab"},z=1e6,U=64e3,N=(n={},(0,y.Z)(n,S.IK.ERROR,15e3),(0,y.Z)(n,S.IK.FULL,3e5),(0,y.Z)(n,S.IK.OFF,0),n),D=function(e){(0,m.Z)(n,e);var t=(0,f.Z)(n);function n(e,s){var a;(0,c.Z)(this,n),(a=t.call(this,e,s,k.t)).events=[],a.backloggedEvents=[],a.harvestTimeSeconds=(0,_.Mt)(a.agentIdentifier,"session_replay.harvestTimeSeconds")||60,a.initialized=!1,a.errorNoticed=!1,a.mode=S.IK.OFF,a.blocked=!1,a.recording=!1,a.shouldCompress=!0,a.hasSnapshot=!1,a.hasMeta=!1,a.hasError=!1,a.cycleTimestamp=void 0,a.payloadBytesEstimation=0,a.lastMeta=void 0;var r=!0===(0,_.Mt)(e,"privacy.cookies_enabled")&&!0===(0,_.Mt)(e,"session_trace.enabled");return a.stopRecording=function(){},r&&(a.ee.on(S.wO.RESET,(function(){a.abort(P)})),a.ee.on(S.wO.PAUSE,(function(){a.stopRecording()})),a.ee.on(S.wO.RESUME,(function(){var e=(0,_.OP)(a.agentIdentifier).session;a.mode=e.state.sessionReplayMode,a.initialized&&a.mode!==S.IK.OFF&&a.startRecording()})),a.ee.on(S.wO.UPDATE,(function(e,t){a.initialized&&!a.blocked&&e===S.uT.CROSS_TAB&&(a.mode!==S.IK.OFF&&t.sessionReplayMode===S.IK.OFF&&a.abort(B),a.mode=t.sessionReplay)})),a.scheduler=new b.o("browser/blobs",{onFinished:a.onHarvestFinished.bind((0,p.Z)(a)),retryDelay:a.harvestTimeSeconds,getPayload:a.prepareHarvest.bind((0,p.Z)(a)),raw:!0},(0,p.Z)(a)),(0,g.X)("errorAgg",(function(e){a.hasError=!0,a.errorNoticed=!0,a.mode===S.IK.ERROR&&"visible"===(null===F._A||void 0===F._A?void 0:F._A.document.visibilityState)&&(a.mode=S.IK.FULL,i&&a.initialized&&(a.stopRecording(),a.startRecording(),a.scheduler.startTimer(a.harvestTimeSeconds),a.syncWithSessionManager({sessionReplayMode:a.mode})))}),a.featureName,a.ee),a.waitForFlags(["sr"]).then((function(e){var t=(0,d.Z)(e,1)[0];return a.initializeRecording(t,100*Math.random()<(0,_.Mt)(a.agentIdentifier,"session_replay.error_sampling_rate"),100*Math.random()<(0,_.Mt)(a.agentIdentifier,"session_replay.sampling_rate"))})).then((function(){return I.m.onReplayReady(a.mode)})),a.drain()),a}return(0,v.Z)(n,[{key:"initializeRecording",value:function(){var e=(0,u.Z)((0,l.Z)().mark((function e(t,n,o){var h,u,d,c,v;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.initialized=!0,t){e.next=3;break}return e.abrupt("return");case 3:if(h=(0,_.OP)(this.agentIdentifier),(u=h.session).isNew){e.next=8;break}this.mode=u.state.sessionReplayMode,e.next=17;break;case 8:if(!o){e.next=12;break}this.mode=S.IK.FULL,e.next=17;break;case 12:if(!n){e.next=16;break}this.mode=S.IK.ERROR,e.next=17;break;case 16:return e.abrupt("return");case 17:return this.mode===S.IK.ERROR&&this.errorNoticed&&(this.mode=S.IK.FULL),e.prev=18,e.next=21,s.e(538).then(s.bind(s,9941));case 21:i=e.sent.record,e.next=27;break;case 24:return e.prev=24,e.t0=e.catch(18),e.abrupt("return",this.abort(x));case 27:return this.mode===S.IK.FULL&&this.scheduler.startTimer(this.harvestTimeSeconds),e.prev=28,e.next=31,s.e(675).then(s.bind(s,1617));case 31:d=e.sent,c=d.gzipSync,v=d.strToU8,a=c,r=v,e.next=41;break;case 38:e.prev=38,e.t1=e.catch(28),this.shouldCompress=!1;case 41:this.startRecording(),this.syncWithSessionManager({sessionReplayMode:this.mode});case 43:case"end":return e.stop()}}),e,this,[[18,24],[28,38]])})));return function(t,s,n){return e.apply(this,arguments)}}()},{key:"prepareHarvest",value:function(){if(0!==this.events.length&&(this.mode===S.IK.FULL||this.blocked)){var e=this.getHarvestContents();if(e.body.length)return this.shouldCompress?(e.body=a(r((0,R.P)(e.body))),this.scheduler.opts.gzip=!0):this.scheduler.opts.gzip=!1,(0,_.OP)(this.agentIdentifier).session.state.sessionReplaySentFirstChunk||this.syncWithSessionManager({sessionReplaySentFirstChunk:!0}),this.clearBuffer(),[e];this.clearBuffer()}}},{key:"getHarvestContents",value:function(){var e,t,s,n,i=(0,_.OP)(this.agentIdentifier),a=(0,_.C5)(this.agentIdentifier);this.backloggedEvents.length&&(this.events=[].concat((0,h.Z)(this.backloggedEvents),(0,h.Z)(this.events))),(null===(e=this.events[0])||void 0===e?void 0:e.type)===C.FullSnapshot&&this.lastMeta&&(this.hasMeta=!0,this.events.unshift(this.lastMeta),this.lastMeta=void 0),(null===(t=this.events[this.events.length-1])||void 0===t?void 0:t.type)===C.Meta&&(this.lastMeta=this.events[this.events.length-1],this.events=this.events.slice(0,this.events.length-1),this.hasMeta=!!this.events.find((function(e){return e.type===C.Meta})));var r=null===(s=this.events[0])||void 0===s?void 0:s.timestamp,l=null===(n=this.events[this.events.length-1])||void 0===n?void 0:n.timestamp,u=r||this.cycleTimestamp,d=l||(0,_.OP)(this.agentIdentifier).offset+F._A.performance.now();return{qs:{browser_monitoring_key:a.licenseKey,type:"SessionReplay",app_id:a.applicationID,protocol_version:"0",attributes:(0,M.j6)((0,o.Z)((0,o.Z)({},this.shouldCompress&&{content_encoding:"gzip"}),{},{"replay.firstTimestamp":u,"replay.lastTimestamp":d,"replay.durationMs":d-u,"replay.nodes":this.events.length,agentVersion:i.version,session:i.session.state.value,hasMeta:this.hasMeta,hasSnapshot:this.hasSnapshot,hasError:this.hasError,isFirstChunk:!1===i.session.state.sessionReplaySentFirstChunk,decompressedBytes:this.payloadBytesEstimation,"nr.rrweb.version":A.lF}),z-this.payloadBytesEstimation).substring(1)},body:this.events}}},{key:"onHarvestFinished",value:function(e){429===e.status&&this.abort(K),this.blocked&&this.scheduler.stopTimer(!0)}},{key:"clearBuffer",value:function(){this.mode===S.IK.ERROR?this.backloggedEvents=this.events:this.backloggedEvents=[],this.events=[],this.hasSnapshot=!1,this.hasMeta=!1,this.hasError=!1,this.payloadBytesEstimation=0,this.clearTimestamps()}},{key:"startRecording",value:function(){var e=this;if(!i)return(0,T.Z)("Recording library was never imported"),this.abort(x);this.recording=!0;var t=(0,_.Mt)(this.agentIdentifier,"session_replay"),s=t.block_class,n=t.ignore_class,a=t.mask_text_class,r=t.block_selector,o=t.mask_input_options,h=t.mask_text_selector,l=t.mask_all_inputs,u=t.inline_images,d=t.inline_stylesheet,c=t.collect_fonts,v=i({emit:this.store.bind(this),blockClass:s,ignoreClass:n,maskTextClass:a,blockSelector:r,maskInputOptions:o,maskTextSelector:h,maskAllInputs:l,inlineImages:u,inlineStylesheet:d,collectFonts:c,checkoutEveryNms:N[this.mode]});this.stopRecording=function(){e.recording=!1,v()}}},{key:"store",value:function(e,t){if(this.setTimestamps(),!this.blocked){var s=(0,R.P)(e).length,n=this.getPayloadSize(s);if(n>z)return this.clearBuffer(),this.abort(L);this.mode===S.IK.ERROR&&t&&e.type===C.Meta&&this.clearBuffer(),e.type===C.Meta&&(this.hasMeta=!0),e.type===C.FullSnapshot&&(this.hasSnapshot=!0),this.events.push(e),this.payloadBytesEstimation+=s,n>U&&this.mode!==S.IK.ERROR&&this.scheduler.runHarvest()}}},{key:"takeFullSnapshot",value:function(){i&&i.takeFullSnapshot()}},{key:"setTimestamps",value:function(){this.cycleTimestamp||(this.cycleTimestamp=(0,_.OP)(this.agentIdentifier).offset+F._A.performance.now())}},{key:"clearTimestamps",value:function(){this.cycleTimestamp=void 0}},{key:"getPayloadSize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.estimateCompression(this.payloadBytesEstimation+e)+1e3}},{key:"abort",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,T.Z)("SR aborted -- ".concat(e.message)),(0,w.p)(O.xS,["SessionReplay/Abort/".concat(e.sm)],void 0,Z.D.metrics,this.ee),this.blocked=!0,this.mode=S.IK.OFF,this.stopRecording(),this.syncWithSessionManager({sessionReplayMode:this.mode}),this.clearTimestamps(),this.ee.emit("REPLAY_ABORTED")}},{key:"estimateCompression",value:function(e){return this.shouldCompress?e*H:e}},{key:"syncWithSessionManager",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,_.OP)(this.agentIdentifier).session.write(e)}}]),n}(E.m);(0,y.Z)(D,"featureName",k.t)},7762:function(e,t,s){s.d(t,{Z:function(){return i}});var n=s(181);function i(e,t){var s="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!s){if(Array.isArray(e)||(s=(0,n.Z)(e))||t&&e&&"number"===typeof e.length){s&&(e=s);var i=0,a=function(){};return{s:a,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,o=!0,h=!1;return{s:function(){s=s.call(e)},n:function(){var e=s.next();return o=e.done,e},e:function(e){h=!0,r=e},f:function(){try{o||null==s.return||s.return()}finally{if(h)throw r}}}}}}]);
//# sourceMappingURL=session_replay-aggregate.0ac95ef8.chunk.js.map