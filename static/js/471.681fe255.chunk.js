"use strict";(self.webpackChunknrug_arrival_form_frontend=self.webpackChunknrug_arrival_form_frontend||[]).push([[471],{9471:function(e,t,i){i.d(t,{IK:function(){return x},wO:function(){return b},uT:function(){return R},$s:function(){return Z}});var n=i(4942),s=i(1413),r=i(5671),o=i(3144),a=i(662),u=i(1760),h=i(8038),c=i(4836),l=function(){function e(t,i){if((0,r.Z)(this,e),!t.onEnd)throw new Error("onEnd handler is required");if(!i)throw new Error("ms duration is required");this.onEnd=t.onEnd,this.initialMs=i,this.startTimestamp=Date.now(),this.timer=this.create(this.onEnd,i)}return(0,o.Z)(e,[{key:"create",value:function(e,t){var i=this;return this.timer&&this.clear(),setTimeout((function(){return e?e():i.onEnd()}),t||this.initialMs)}},{key:"clear",value:function(){clearTimeout(this.timer),this.timer=null}},{key:"end",value:function(){this.clear(),this.onEnd()}},{key:"isValid",value:function(){return this.initialMs-(Date.now()-this.startTimestamp)>0}}]),e}(),f=i(3980),d=i(2162),v=i(7326),m=i(136),p=i(9388),y=i(536),k=i(1043),g=function(e){(0,m.Z)(i,e);var t=(0,p.Z)(i);function i(e,n){var s;(0,r.Z)(this,i),(s=t.call(this,e,n)).onPause="function"===typeof e.onPause?e.onPause:function(){},s.onRefresh="function"===typeof e.onRefresh?e.onRefresh:function(){},s.onResume="function"===typeof e.onResume?e.onResume:function(){},s.remainingMs=void 0,e.refreshEvents||(e.refreshEvents=["click","keydown","scroll"]);try{s.abortController=new AbortController}catch(u){}if(f.il&&e.ee){var o;if(e.ee){s.ee=e.ee;var a=(0,k.D)(s.refresh.bind((0,v.Z)(s)),500,{leading:!0});s.refreshHandler=function(t){var i;e.refreshEvents.includes(null===t||void 0===t||null===(i=t[0])||void 0===i?void 0:i.type)&&a()},e.ee.on("fn-end",s.refreshHandler)}(0,y.N)((function(e){"hidden"===e?s.pause():s.resume()}),!1,!1,null===(o=s.abortController)||void 0===o?void 0:o.signal)}return s}return(0,o.Z)(i,[{key:"abort",value:function(){var e;this.clear(),null===(e=this.abortController)||void 0===e||e.abort(),this.refreshHandler&&(this.ee.removeEventListener("fn-end",this.refreshHandler),this.refreshHandler=this.ee=null)}},{key:"pause",value:function(){this.onPause(),clearTimeout(this.timer),this.remainingMs=this.initialMs-(Date.now()-this.startTimestamp)}},{key:"resume",value:function(){this.refresh(),this.onResume()}},{key:"refresh",value:function(e,t){this.clear(),this.timer=this.create(e,t),this.startTimestamp=Date.now(),this.remainingMs=void 0,this.onRefresh()}}]),i}(l),w=i(5950),E=i(8673),A=i(5894),M=i(6477),S=i(9025),T=i(1997),x={OFF:0,FULL:1,ERROR:2},D={value:"",inactiveAt:0,expiresAt:0,updatedAt:Date.now(),sessionReplayMode:x.OFF,sessionReplaySentFirstChunk:!1,sessionTraceMode:x.OFF,traceHarvestStarted:!1,custom:{}},b={PAUSE:"session-pause",RESET:"session-reset",RESUME:"session-resume",UPDATE:"session-update"},R={SAME_TAB:"same-tab",CROSS_TAB:"cross-tab"},Z=function(){function e(t){var i=this;(0,r.Z)(this,e);var n=t.agentIdentifier,s=t.key,o=t.storage;if(!n||!s||!o)throw new Error("Missing required field(s):".concat(n?"":" agentID").concat(s?"":" key").concat(o?"":" storage"));this.agentIdentifier=n,this.storage=o,this.state={},this.key=s,this.ee=c.ee.get(n),(0,w.em)(this.ee),this.setup(t),f.il&&(0,T.bP)("storage",(function(e){if(e.key===i.lookupKey){var t="string"===typeof e.newValue?JSON.parse(e.newValue):e.newValue;i.sync(t),i.ee.emit(b.UPDATE,[R.CROSS_TAB,i.state])}}))}return(0,o.Z)(e,[{key:"setup",value:function(e){var t=this,i=e.value,n=void 0===i?(0,a.ky)(16):i,s=e.expiresMs,r=void 0===s?d.oD:s,o=e.inactiveMs,u=void 0===o?d.Hb:o;this.state={},this.sync(D),this.state.value=n,this.expiresMs=r,this.inactiveMs=u;var h=this.read();r?(this.state.expiresAt=(null===h||void 0===h?void 0:h.expiresAt)||this.getFutureTimestamp(r),this.expiresTimer=new l({onEnd:function(){t.collectSM("expired",t),t.collectSM("duration",t),t.reset()}},this.state.expiresAt-Date.now())):this.state.expiresAt=1/0,u?(this.state.inactiveAt=(null===h||void 0===h?void 0:h.inactiveAt)||this.getFutureTimestamp(u),this.inactiveTimer=new g({onEnd:function(){t.collectSM("inactive",t),t.collectSM("duration",t),t.reset()},onRefresh:this.refresh.bind(this),onResume:function(){t.ee.emit(b.RESUME)},onPause:function(){t.initialized&&t.ee.emit(b.PAUSE),t.write((0,E.D)(t.state,D))},ee:this.ee,refreshEvents:["click","keydown","scroll"]},this.state.inactiveAt-Date.now())):this.state.inactiveAt=1/0,this.isNew=!Object.keys(h).length,this.isNew?this.write((0,E.D)(this.state,D),!0):this.sync(h),this.initialized=!0}},{key:"lookupKey",get:function(){return"".concat(d.Bq,"_").concat(this.key)}},{key:"sync",value:function(e){Object.assign(this.state,e)}},{key:"read",value:function(){try{var e=this.storage.get(this.lookupKey);if(!e)return{};var t="string"===typeof e?JSON.parse(e):e;return this.isInvalid(t)?{}:this.isExpired(t.expiresAt)?(this.collectSM("expired",this),this.collectSM("duration",t,!0),this.reset()):this.isExpired(t.inactiveAt)?(this.collectSM("inactive",this),this.collectSM("duration",t,!0),this.reset()):t}catch(i){return(0,u.Z)("Failed to read from storage API",i),{}}}},{key:"write",value:function(e){try{if(!e||"object"!==typeof e)return;return e.updatedAt=Date.now(),this.sync(e),this.storage.set(this.lookupKey,(0,h.P)(this.state)),this.ee.emit(b.UPDATE,[R.SAME_TAB,this.state]),e}catch(t){return(0,u.Z)("Failed to write to the storage API",t),null}}},{key:"reset",value:function(){try{var e,t,i,n;return this.initialized&&this.ee.emit(b.RESET),this.storage.remove(this.lookupKey),null===(e=this.inactiveTimer)||void 0===e||null===(t=e.abort)||void 0===t||t.call(e),null===(i=this.expiresTimer)||void 0===i||null===(n=i.clear)||void 0===n||n.call(i),delete this.isNew,this.setup({agentIdentifier:this.agentIdentifier,key:this.key,storage:this.storage,expiresMs:this.expiresMs,inactiveMs:this.inactiveMs}),this.read()}catch(s){return{}}}},{key:"refresh",value:function(){var e=this.read();this.write((0,s.Z)((0,s.Z)({},e),{},{inactiveAt:this.getFutureTimestamp(this.inactiveMs)}))}},{key:"isExpired",value:function(e){return Date.now()>e}},{key:"isInvalid",value:function(e){return!Object.keys(D).every((function(t){return Object.keys(e).includes(t)}))}},{key:"collectSM",value:function(e,t,i){var n,s;if("duration"===e){var r=t.expiresAt-t.expiresMs;n=(i?t.updatedAt:Date.now())-r,s="Session/Duration/Ms"}"expired"===e&&(s="Session/Expired/Seen"),"inactive"===e&&(s="Session/Inactive/Seen"),s&&(0,A.p)(M.xS,[s,n],void 0,S.D.metrics,this.ee)}},{key:"getFutureTimestamp",value:function(e){return Date.now()+e}},{key:"syncCustomAttribute",value:function(e,t){if(f.il)if(null===t){var i=this.read();i.custom&&(delete i.custom[e],this.write((0,s.Z)({},i)))}else{var r=this.read();this.custom=(0,s.Z)((0,s.Z)({},(null===r||void 0===r?void 0:r.custom)||{}),{},(0,n.Z)({},e,t)),this.write((0,s.Z)((0,s.Z)({},r),{},{custom:this.custom}))}}}]),e}()},1043:function(e,t,i){function n(e){var t,i=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:500,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=(null===s||void 0===s?void 0:s.leading)||!1;return function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];r&&void 0===t&&(e.apply(i,o),t=setTimeout((function(){t=clearTimeout(t)}),n)),r||(clearTimeout(t),t=setTimeout((function(){e.apply(i,o)}),n))}}function s(e){var t=this,i=!1;return function(){if(!i){i=!0;for(var n=arguments.length,s=new Array(n),r=0;r<n;r++)s[r]=arguments[r];e.apply(t,s)}}}i.d(t,{D:function(){return n},Z:function(){return s}})}}]);
//# sourceMappingURL=471.681fe255.chunk.js.map